/*
 * FlexMaestro Service
 * This is a basic FlexMaestro service, showcasing many features of a standard Twilio Service
 *
 * The version of the OpenAPI document: 1.0.0
 * Contact: your-team-name@twilio.com
 *
 * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).
 * https://openapi-generator.tech
 * Do not edit the class manually.
 */

package com.twilio.flexmaestro.server.api;
import com.twilio.coreutil.service.jakarta.api.bundles.ConfiguredBundle;
import com.twilio.coreutil.service.jakarta.api.application.Bootstrap;
import com.twilio.coreutil.service.jakarta.api.application.Environment;
import jakarta.inject.Inject;
import org.jvnet.hk2.annotations.Service;

import com.twilio.ratelimit.bundle.config.RateLimitConfigurationStrategy;

import com.twilio.flexmaestro.server.api.admin.*;
import com.twilio.flexmaestro.server.api.hello.message.*;

/**
 * Bundle for registering Jersey resources.
 * Add this bundle in your application's initialization method, to register all the resources.
 */
@Service
public final class ResourceBundle<T> implements ConfiguredBundle<T> {
    private final AdminApi adminApiHandler;
    private final HelloMessageApi helloMessageApiHandler;

    @Inject
    public ResourceBundle(
                    final AdminApi adminApiHandler, 
                    final HelloMessageApi helloMessageApiHandler) {
        this.adminApiHandler = adminApiHandler;
        this.helloMessageApiHandler = helloMessageApiHandler;
    }

    @Override
    public void run(final T configuration, final Environment environment) {
        if (adminApiHandler != null) {
            environment.jersey().register(new AdminApiResource(adminApiHandler));
            if (configuration instanceof RateLimitConfigurationStrategy
                        && ((RateLimitConfigurationStrategy) configuration).getRateLimitConfiguration().getEnabled()) {
                environment.jersey().register(new AdminApiResource.AdminApiFilterFactory());
            }
        }
        if (helloMessageApiHandler != null) {
            environment.jersey().register(new HelloMessageApiResource(helloMessageApiHandler));
            if (configuration instanceof RateLimitConfigurationStrategy
                        && ((RateLimitConfigurationStrategy) configuration).getRateLimitConfiguration().getEnabled()) {
                environment.jersey().register(new HelloMessageApiResource.HelloMessageApiFilterFactory());
            }
        }
    }

    @Override
    public void initialize(final Bootstrap<?> bootstrap) {
    }
 }